"use strict";(self.webpackChunkfury=self.webpackChunkfury||[]).push([[325],{2325:(J,f,n)=>{n.r(f),n.d(f,{LoginModule:()=>M});var p=n(6895),a=n(4006),y=n(7027),d=n(6630),s=n(7340);const w=(0,s.X$)("fadeInUp",[(0,s.eR)(":enter",[(0,s.oB)({transform:"translateY(3vh)",opacity:0}),(0,s.jt)("400ms cubic-bezier(0.35, 0, 0.25, 1)",(0,s.oB)({transform:"translateY(0)",opacity:1}))])]);var t=n(4650),h=n(2340),m=n(5439),I=n(529);let v=(()=>{class e{constructor(o,i){this.http=o,this.router=i}login(o,i){var l=new FormData;return l.append("email",o),l.append("password",i),this.http.post(h.N.authUrl,l).subscribe({next:c=>this.loginResult(c),error:c=>this.loginError(c)}),{email:o,password:i}}loginByToken(){return this.http.post(h.N.refreshUrl,null).subscribe({next:o=>console.log(o),error:o=>console.error(o)}),null}loginResult(o){return!(!o||!o.authenticated)&&(window.localStorage.setItem("loggedIn",o.authenticated),window.localStorage.setItem("token",o.authorisation.token),window.localStorage.setItem("userId",o.user.id),window.localStorage.setItem("username",o.user.name),window.localStorage.setItem("lastlogin",m().format()),this.router.navigate(["/"]),o.authenticated)}loginError(o){console.log("loginError: ",o)}logout(){window.localStorage.removeItem("token"),window.localStorage.removeItem("loggedIn"),window.localStorage.removeItem("userId"),window.localStorage.removeItem("username"),window.localStorage.removeItem("lastlogin"),this.router.navigate(["/login"])}isLoggedIn(){return"true"===window.localStorage.getItem("loggedIn")}refreshToken(o){return""!==o.Token&&void 0!==o.Token&&(window.localStorage.setItem("token",o.Token),window.localStorage.setItem("lastlogin",m().toISOString())),o}requiresTokenCheck(){const o=window.localStorage.getItem("lastlogin");return!o||!m().add(60,"minutes").isAfter(m(o))}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(I.eN),t.LFG(d.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})();var u=n(9549),x=n(4144),T=n(7392),L=n(4859),S=n(1733),g=n(1576);function C(e,r){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"We need an email address to log you in"),t.qZA())}function Z(e,r){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"visibility"),t.qZA())}function b(e,r){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"visibility_off"),t.qZA())}function U(e,r){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"We need a password to log you in"),t.qZA())}const A=[{path:"",component:(()=>{class e{constructor(o,i,l){this.fb=o,this.cd=i,this.userService=l,this.inputType="password",this.visible=!1}ngOnInit(){this.form=this.fb.group({email:["",a.kI.required],password:["",a.kI.required]})}send(){console.log(this.form.value.email,this.form.value.password),this.userService.login(this.form.value.email,this.form.value.password)}toggleVisibility(){this.visible?(this.inputType="password",this.visible=!1,this.cd.markForCheck()):(this.inputType="text",this.visible=!0,this.cd.markForCheck())}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(a.QS),t.Y36(t.sBO),t.Y36(v))},e.\u0275cmp=t.Xpm({type:e,selectors:[["fury-login"]],decls:23,vars:7,consts:[["fxLayout","column","fxLayoutAlign","center center",1,"page","background-pattern"],[1,"card","border-radius","elevation"],["fxLayout","column","fxLayoutAlign","center center",1,"header","padding","background-primary"],[1,"logo","fill-primary-contrast"],["fxLayout","column","fxLayoutGap","16px",1,"padding",3,"formGroup"],["fxFlex","auto","fxLayout","column"],["fxFlex","grow"],["matInput","","required","","formControlName","email"],[4,"ngIf"],["matInput","","formControlName","password","required","",3,"type"],["type","button","mat-icon-button","","matSuffix","","matTooltip","Toggle Visibility",3,"click"],["type","button","color","primary","mat-raised-button","",3,"click"]],template:function(o,i){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"div",3),t.qZA(),t.TgZ(4,"div",4)(5,"div",5)(6,"mat-form-field",6)(7,"mat-label"),t._uU(8,"E-Mail"),t.qZA(),t._UZ(9,"input",7),t.YNc(10,C,2,0,"mat-error",8),t.qZA(),t.TgZ(11,"mat-form-field",6)(12,"mat-label"),t._uU(13,"Password"),t.qZA(),t._UZ(14,"input",9),t.TgZ(15,"button",10),t.NdJ("click",function(){return i.toggleVisibility()}),t.YNc(16,Z,2,0,"mat-icon",8),t.YNc(17,b,2,0,"mat-icon",8),t.qZA(),t.TgZ(18,"mat-hint"),t._uU(19,"Click the eye to toggle visibility"),t.qZA(),t.YNc(20,U,2,0,"mat-error",8),t.qZA()(),t.TgZ(21,"button",11),t.NdJ("click",function(){return i.send()}),t._uU(22," SIGN IN "),t.qZA()()()()),2&o&&(t.xp6(1),t.Q6J("@fadeInUp",void 0),t.xp6(3),t.Q6J("formGroup",i.form),t.xp6(6),t.Q6J("ngIf",i.form.get("email").hasError("required")),t.xp6(4),t.Q6J("type",i.inputType),t.xp6(2),t.Q6J("ngIf",i.visible),t.xp6(1),t.Q6J("ngIf",!i.visible),t.xp6(3),t.Q6J("ngIf",i.form.get("password").hasError("required")))},dependencies:[p.O5,u.TO,u.KE,u.bx,u.hX,u.R9,x.Nt,T.Hw,L.lW,S.gM,g.xw,g.SQ,g.Wh,g.yH,a.Fj,a.JJ,a.JL,a.Q7,a.sg,a.u],styles:[".page[_ngcontent-%COMP%]{display:block;height:100%;width:100%}.card[_ngcontent-%COMP%]{width:380px}@media screen and (max-width: 599px){.card[_ngcontent-%COMP%]{width:300px}}.card[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{border-top-left-radius:8px;border-top-right-radius:8px}.logo[_ngcontent-%COMP%]{width:80px;height:80px}"],data:{animation:[w]}}),e})()}];let k=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[d.Bz.forChild(A),d.Bz]}),e})(),M=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[v],imports:[p.ez,k,y.q,a.UX]}),e})()}}]);